<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>TimeTracker</title>

    <!-- Viewport Settings (Mobile Optimization) -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <!-- Stylesheets -->
    <link rel="stylesheet" href="css/style.css">

    <!-- PWA Configuration -->
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#4a90e2">
    <meta name="mobile-web-app-capable" content="yes"> 
    
    <!-- iOS Specific Support -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
</head>
<body>

    <!-- Global App Header -->
    <header class="app-header">
        <h1>TimeTracker</h1>

        <div class="header-actions">
            <!-- Quick Save Button -->
            <button id="btn-quick-save" class="btn-icon" aria-label="Backup Data" title="Save Backup">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"></path>
                    <polyline points="17 21 17 13 7 13 7 21"></polyline>
                    <polyline points="7 3 7 8 15 8"></polyline>
                </svg>
            </button>

            <!-- Settings Button -->
            <button id="btn-settings" class="btn-icon" aria-label="Settings" title="Settings">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M10.3 4.3c.4-1.8 2.9-1.8 3.4 0a1.7 1.7 0 0 0 2.6 1.1c1.5-.9 3.3.8 2.4 2.4a1.7 1.7 0 0 0 1.1 2.6c1.8.4 1.8 2.9 0 3.4a1.7 1.7 0 0 0-1.1 2.6c.9 1.5-.8 3.3-2.4 2.4a1.7 1.7 0 0 0-2.6 1.1c-.4 1.8-2.9 1.8-3.4 0a1.7 1.7 0 0 0-2.6-1.1c-1.5.9-3.3-.8-2.4-2.4a1.7 1.7 0 0 0-1.1-2.6c-1.8-.4-1.8-2.9 0-3.4a1.7 1.7 0 0 0 1.1-2.6c-.9-1.5.8-3.3 2.4-2.4a1.7 1.7 0 0 0 2.6-1.1z"></path>
                    <circle cx="12" cy="12" r="3"></circle>
                </svg>
            </button>
        </div>
    </header>

    <main>
        
        <!-- =========================================== VIEW 1: DASHBOARD (Timer & Recent List) ============================================ -->
        <div id="dashboard-view">
            <section class="timer-container">
                <div class="task-input-group">
                    <input type="text" id="task-name" placeholder="What are you working on?">
                    <select id="category-select">
                        <option value="work">Work</option>
                        <option value="study">Study</option>
                        <option value="break">Break</option>
                    </select>
                </div>
                
                <div class="timer-display" id="timer-display">00:00</div>
                
                <div class="controls">
                    <button id="btn-start" class="btn-primary">Start</button>
                    <button id="btn-pause" class="btn-secondary" hidden>Pause</button>
                    <button id="btn-stop" class="btn-danger">Stop</button>
                </div>
            </section>

            <section class="history-container">
                <h2>Recent Sessions</h2>
                <div id="recent-history-list">
                    <!-- Populated by JS -->
                </div>
                <!-- "View All" button injected here -->
            </section>
        </div>

        <!-- =================================================== VIEW 2: FULL HISTORY =================================================== -->
        <div id="history-view" hidden>
            <div class="history-sticky-header">
                <div class="header-left">
                    <button id="btn-back-to-dashboard" class="btn-icon" aria-label="Back">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M19 12H5M12 19l-7-7 7-7"/>
                        </svg>
                    </button>
                    <h2>All Tasks</h2>
                </div>
                
                <div class="header-right">
                    <button id="btn-export-csv" class="btn-small">ðŸ“„ CSV</button>
                    <button id="btn-export-json" class="btn-small">ðŸ’¾ JSON</button>
                </div>
            </div>

            <div id="full-history-list" class="scrollable-list-content">
                <!-- Populated by JS -->
            </div>
        </div>

        <!-- =================================================== VIEW 3: EDIT SESSION =================================================== -->
        <div id="edit-view" hidden>
            <div class="history-sticky-header">
                <div class="header-left">
                    <button id="btn-back-from-edit" class="btn-icon" aria-label="Back">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M19 12H5M12 19l-7-7 7-7"/>
                        </svg>
                    </button>
                    <h2>Edit Session</h2>
                </div>
                
                <div class="header-right">
                    <button id="btn-save-edit" class="btn-icon" style="color: var(--primary-color);" aria-label="Save">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M20 6L9 17l-5-5"/>
                        </svg>
                    </button>
                </div>
            </div>

            <div class="scrollable-list-content">
                <!-- Read Only Info -->
                <div style="text-align: center; margin-bottom: 2rem;">
                    <p style="color:#888; font-size: 0.9rem;">Total Duration</p>
                    <div id="edit-display-time" style="font-size: 2.5rem; font-weight: bold; color: var(--primary-color);">
                        00:00
                    </div>
                    <p id="edit-display-date" style="color:#888; font-size: 0.8rem; margin-top:5px;">
                        Oct 24, 2025
                    </p>
                </div>

                <!-- Inputs -->
                <div class="task-input-group">
                    <label for="edit-task-name" style="font-size: 0.9rem; font-weight: 600;">Task Name</label>
                    <input type="text" id="edit-task-name">
                    
                    <label for="edit-category-select" style="font-size: 0.9rem; font-weight: 600;">Category</label>
                    <select id="edit-category-select">
                        <option value="work">Work</option>
                        <option value="study">Study</option>
                        <option value="break">Break</option>
                    </select>
                </div>

                <button id="btn-delete-session" class="btn-danger" style="width: 100%; margin-top: 2rem;">
                    Delete Session
                </button>
            </div>
        </div>

        <!-- ============================================== VIEW 4: SETTINGS ============================================== -->
        <div id="settings-view" hidden>
            <div class="history-sticky-header">
                <div class="header-left">
                    <button id="btn-back-from-settings" class="btn-icon" aria-label="Back">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M19 12H5M12 19l-7-7 7-7"/>
                        </svg>
                    </button>
                    <h2>Settings</h2>
                </div>
            </div>

            <div class="scrollable-list-content">

                <!-- Group: Time Alerts -->
                <div class="settings-group">
                    <h3>Time Alerts (Minutes)</h3>
                    <p style="font-size: 0.8rem; color:#666; margin-bottom:10px;">
                        Play a sound when you reach this duration. Set to 0 to disable.
                    </p>
                    
                    <div class="setting-item">
                        <label for="limit-work">Work</label>
                        <input type="number" id="limit-work" class="input-small" placeholder="0" min="0">
                    </div>
                    
                    <div class="setting-item">
                        <label for="limit-study">Study</label>
                        <input type="number" id="limit-study" class="input-small" placeholder="0" min="0">
                    </div>
                    
                    <div class="setting-item">
                        <label for="limit-break">Break</label>
                        <input type="number" id="limit-break" class="input-small" placeholder="0" min="0">
                    </div>

                    <button id="btn-req-notify" class="btn-small" style="width:100%; margin-top:10px;">
                        ðŸ”” Enable Desktop Notifications
                    </button>
                </div>
                
                <!-- Group: Data Management -->
                <div class="settings-group">
                    <h3>Data Management</h3>
                    
                    <div class="setting-item">
                        <div>
                            <h4>Import Backup</h4>
                            <p>Restore history from JSON file</p>
                        </div>
                        <label for="file-import" class="btn-small" style="cursor:pointer;">
                            Select File
                        </label>
                        <input type="file" id="file-import" accept=".json" hidden>
                    </div>
                </div>

                <!-- Group: Appearance -->
                <div class="settings-group">
                    <h3>Appearance</h3>
                    <div class="setting-item">
                        <div>
                            <h4>Dark Mode</h4>
                            <p>Coming soon...</p>
                        </div>
                        <button class="btn-small" disabled>Auto</button>
                    </div>
                </div>

            </div>
        </div>
    </main>

    <!-- Application Scripts -->
    <script type="module" src="js/app.js"></script>
</body>
</html>